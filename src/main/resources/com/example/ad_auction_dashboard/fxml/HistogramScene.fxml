<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Slider?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.ToggleButton?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" prefHeight="700.0" prefWidth="900.0" styleClass="histogram-scene" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.example.ad_auction_dashboard.controller.HistogramController">
    <top>
        <VBox spacing="5.0" BorderPane.alignment="CENTER">
            <padding>
                <Insets bottom="5.0" left="10.0" right="10.0" top="10.0" />
            </padding>

            <!-- Navigation bar with back, export/print, and logout buttons -->
            <HBox alignment="CENTER_LEFT" spacing="10.0">
                <Button fx:id="backButton" onAction="#handleBackToMetrics" styleClass="transparent-button">
                    <graphic>
                        <ImageView fitHeight="36.0" fitWidth="38.0" pickOnBounds="true" preserveRatio="true" styleClass="back">
                            <image>
                                <Image url="@../../../../images/back button.png" />
                            </image>
                        </ImageView>
                    </graphic>
                </Button>

                <Region HBox.hgrow="ALWAYS" />
                <ToggleButton fx:id="colourSwitch" alignment="CENTER_LEFT" minWidth="60.0" mnemonicParsing="false" onAction="#toggleColour" prefHeight="30.0" prefWidth="65.0" styleClass="colour-switch" stylesheets="@../../../../styles/style.css" />

                <ComboBox fx:id="exportComboBox" prefWidth="150.0" promptText="Export Format" />
                <Button fx:id="exportButton" onAction="#exportData" styleClass="nav-button" text="Export" />
                <Button fx:id="printButton" onAction="#printData" styleClass="nav-button" text="Print" />

                <Region minWidth="20.0" />


            </HBox>

            <!-- Filter controls in a clean HBox layout -->
            <HBox alignment="CENTER_LEFT" spacing="10.0" styleClass="chart-setting-container">
                <padding>
                    <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                </padding>

                <!-- Date range -->
                <Label styleClass="filter-label" text="Date Range:" textFill="WHITE" />
                <DatePicker fx:id="startDatePicker" prefWidth="150.0" promptText="Start Date" />
                <Label styleClass="filter-label" text="to" textFill="WHITE" />
                <DatePicker fx:id="endDatePicker" prefWidth="150.0" promptText="End Date" />
                <ComboBox fx:id="histogramTypeComboBox" prefWidth="150.0" style="-fx-background-color: #363642; -fx-text-fill: white;" visible="false" />

                <Region minWidth="20.0" HBox.hgrow="ALWAYS" />
                                             <Slider fx:id="binSizeSlider" blockIncrement="1.0" majorTickUnit="5.0" max="20.0" min="5.0" minorTickCount="4" showTickLabels="false" showTickMarks="false" snapToTicks="true" style="-fx-control-inner-background: #8884;" value="10.0">
                                                 <HBox.margin>
                                                     <Insets right="20.0" />
                                                 </HBox.margin>
                                             </Slider>
                                             <!-- Increased width for bin size label -->
                                             <Label fx:id="binSizeLabel" minWidth="80.0" styleClass="bin-size-label" text="Num: 10" textFill="WHITE">
                                                 <font>
                                                     <Font size="14.0" />
                                                 </font>
                                                 <HBox.margin>
                                                     <Insets right="20.0" />
                                                 </HBox.margin>
                                             </Label>
            </HBox>

            <!-- Second row of filters -->
            <HBox alignment="CENTER_LEFT" spacing="10.0" styleClass="chart-setting-container">
                <padding>
                    <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                </padding>

                <Label styleClass="filter-label" text="Gender:" textFill="WHITE" />
                <ComboBox fx:id="genderFilterComboBox" prefWidth="100.0" />

                <Label styleClass="filter-label" text="Age:" textFill="WHITE" />
                <ComboBox fx:id="ageFilterComboBox" prefWidth="100.0" />

                <Label styleClass="filter-label" text="Income:" textFill="WHITE" />
                <ComboBox fx:id="incomeFilterComboBox" prefWidth="100.0" />

                <Label styleClass="filter-label" text="Context:" textFill="WHITE" />
                <ComboBox fx:id="contextFilterComboBox" prefWidth="130.0" />

                <Region minWidth="20.0" HBox.hgrow="ALWAYS" />

                <Button fx:id="resetFiltersButton" onAction="#handleResetFilters" styleClass="nav-button" text="Reset Filters" />
            </HBox>

            <!-- Status label for feedback -->
            <Label fx:id="statusLabel" style="-fx-text-fill: #ffcc66; -fx-font-style: italic;" />
            <Label fx:id="printLabel" style="-fx-text-fill: #ffcc66; -fx-font-style: italic;" />
        </VBox>
<!--        <VBox spacing="10.0" styleClass="gauge-super-container" BorderPane.alignment="CENTER">-->
<!--            <children>-->
<!--                &lt;!&ndash; Navigation buttons in corners &ndash;&gt;-->
<!--                <HBox alignment="CENTER" styleClass="gauge-container">-->
<!--                    <children>-->
<!--                        &lt;!&ndash; Back button at left corner &ndash;&gt;-->
<!--                        <Button fx:id="backButton" mnemonicParsing="false" onAction="#handleBackToMetrics" prefHeight="50.0" prefWidth="40.0" styleClass="transparent-button">-->
<!--                            <graphic>-->
<!--                                <ImageView fitHeight="36.0" fitWidth="38.0" pickOnBounds="true" preserveRatio="true" styleClass="back">-->
<!--                                    <image>-->
<!--                                        <Image url="@../../../../images/back button.png" />-->
<!--                                    </image>-->
<!--                                </ImageView>-->
<!--                            </graphic>-->
<!--                        </Button>-->

<!--                        &lt;!&ndash; Flexible space between buttons &ndash;&gt;-->
<!--                        <Region HBox.hgrow="ALWAYS" />-->

<!--                        &lt;!&ndash; Filters Container &ndash;&gt;-->
<!--                        <HBox alignment="CENTER" spacing="15.0" style="-fx-background-radius: 10;">-->
<!--                            <children>-->
<!--                                &lt;!&ndash; Gender Filter &ndash;&gt;-->
<!--                                <Label minWidth="60.0" styleClass="admin-text" text="Gender:" textFill="WHITE">-->
<!--                                    <font>-->
<!--                                        <Font size="14.0" />-->
<!--                                    </font>-->
<!--                                </Label>-->
<!--                                <ComboBox fx:id="genderFilterComboBox" prefWidth="100.0" styleClass="histogram-select" />-->

<!--                                &lt;!&ndash; Age Filter (New) &ndash;&gt;-->
<!--                                <Label minWidth="40.0" styleClass="admin-text" text="Age:" textFill="WHITE">-->
<!--                                    <font>-->
<!--                                        <Font size="14.0" />-->
<!--                                    </font>-->
<!--                                </Label>-->
<!--                                <ComboBox fx:id="ageFilterComboBox" prefWidth="100.0" styleClass="histogram-select" />-->

<!--                                &lt;!&ndash; Income Filter (New) &ndash;&gt;-->
<!--                                <Label minWidth="60.0" styleClass="admin-text" text="Income:" textFill="WHITE">-->
<!--                                    <font>-->
<!--                                        <Font size="14.0" />-->
<!--                                    </font>-->
<!--                                </Label>-->
<!--                                <ComboBox fx:id="incomeFilterComboBox" prefWidth="100.0" styleClass="histogram-select" />-->

<!--                                &lt;!&ndash; Context Filter &ndash;&gt;-->
<!--                                <Label minWidth="70.0" styleClass="admin-text" text="Context:" textFill="WHITE">-->
<!--                                    <font>-->
<!--                                        <Font size="14.0" />-->
<!--                                    </font>-->
<!--                                </Label>-->
<!--                                <ComboBox fx:id="contextFilterComboBox" prefWidth="120.0" styleClass="histogram-select" />-->

<!--                                &lt;!&ndash; Reset Button &ndash;&gt;-->
<!--                                <Button fx:id="resetFiltersButton" mnemonicParsing="false" onAction="#handleResetFilters" prefHeight="25.0" prefWidth="134.0" styleClass="histogram-select" text="Reset Filters" />-->
<!--                            </children>-->
<!--                            <padding>-->
<!--                                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />-->
<!--                            </padding>-->
<!--                        </HBox>-->

<!--                        &lt;!&ndash; Log off button at right corner &ndash;&gt;-->
<!--                        <Button fx:id="logoutBtn" mnemonicParsing="false" onAction="#handleLogout" prefHeight="25.0" prefWidth="43.0" styleClass="transparent-button">-->
<!--                            <graphic>-->
<!--                                <ImageView fitHeight="35.0" fitWidth="32.0" pickOnBounds="true" preserveRatio="true" styleClass="logoff">-->
<!--                                    <image>-->
<!--                                        <Image url="@../../../../images/white log off.png" />-->
<!--                                    </image>-->
<!--                                </ImageView>-->
<!--                            </graphic>-->
<!--                        </Button>-->
<!--                  <ToggleButton fx:id="colourSwitch" alignment="CENTER_LEFT" minWidth="60.0" mnemonicParsing="false" onAction="#toggleColour" prefHeight="30.0" prefWidth="65.0" styleClass="colour-switch" stylesheets="@../../../../styles/style.css" />-->
<!--                    </children>-->
<!--                    <padding>-->
<!--                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />-->
<!--                    </padding>-->
<!--                </HBox>-->
<!--                <VBox prefHeight="67.0" prefWidth="879.0">-->
<!--                    <children>-->

<!--                        &lt;!&ndash; Date range and bin controls &ndash;&gt;-->
<!--                        <HBox alignment="CENTER_LEFT" spacing="15.0" style="-fx-background-radius: 10;">-->
<!--                            <children>-->
<!--                                &lt;!&ndash; Fixed width for label to avoid truncation &ndash;&gt;-->
<!--                                <Label minWidth="100.0" styleClass="admin-text" text="Date Range:" textFill="WHITE">-->
<!--                                    <font>-->
<!--                                        <Font size="14.0" />-->
<!--                                    </font>-->
<!--                                </Label>-->
<!--                                <DatePicker fx:id="startDatePicker" promptText="Start Date" style="-fx-background-color: #363642; -fx-text-fill: white;" />-->
<!--                                &lt;!&ndash; Extra spacing and minimum width &ndash;&gt;-->
<!--                                <Label minWidth="30.0" styleClass="admin-text" text="to" textFill="WHITE">-->
<!--                                    <font>-->
<!--                                        <Font size="14.0" />-->
<!--                                    </font>-->
<!--                                    <HBox.margin>-->
<!--                                        <Insets left="5.0" right="5.0" />-->
<!--                                    </HBox.margin>-->
<!--                                </Label>-->
<!--                                <DatePicker fx:id="endDatePicker" promptText="End Date" style="-fx-background-color: #363642; -fx-text-fill: white;" />-->

<!--                                &lt;!&ndash; Add the missing histogramTypeComboBox &ndash;&gt;-->
<!--                                <ComboBox fx:id="histogramTypeComboBox" prefWidth="150.0" style="-fx-background-color: #363642; -fx-text-fill: white;" visible="false" />-->

<!--                                &lt;!&ndash; Increased width for label &ndash;&gt;-->
<!--                                <Label minWidth="50.0" styleClass="admin-text" text="bins:" textFill="WHITE">-->
<!--                                    <font>-->
<!--                                        <Font size="14.0" />-->
<!--                                    </font>-->
<!--                                    <HBox.margin>-->
<!--                                        <Insets left="60.0" />-->
<!--                                    </HBox.margin>-->
<!--                                </Label>-->
<!--                                <Slider fx:id="binSizeSlider" blockIncrement="1.0" majorTickUnit="5.0" max="20.0" min="5.0" minorTickCount="4" showTickLabels="false" showTickMarks="false" snapToTicks="true" style="-fx-control-inner-background: #8884;" value="10.0">-->
<!--                                    <HBox.margin>-->
<!--                                        <Insets right="20.0" />-->
<!--                                    </HBox.margin>-->
<!--                                </Slider>-->
<!--                                &lt;!&ndash; Increased width for bin size label &ndash;&gt;-->
<!--                                <Label fx:id="binSizeLabel" minWidth="80.0" styleClass="bin-size-label" text="Num: 10" textFill="WHITE">-->
<!--                                    <font>-->
<!--                                        <Font size="14.0" />-->
<!--                                    </font>-->
<!--                                    <HBox.margin>-->
<!--                                        <Insets right="20.0" />-->
<!--                                    </HBox.margin>-->
<!--                                </Label>-->
<!--                            </children>-->
<!--                            <padding>-->
<!--                                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />-->
<!--                            </padding>-->
<!--                        </HBox>-->
<!--                        <HBox prefHeight="100.0" prefWidth="200.0">-->
<!--                            <children>-->
<!--                                <Region prefHeight="27.0" prefWidth="7.0" />-->
<!--                                <ComboBox fx:id="exportComboBox" prefWidth="150.0" />-->
<!--                                <Button fx:id="exportButton" mnemonicParsing="false" onAction="#exportData" prefHeight="18.0" prefWidth="55.0" styleClass="histogram-export-button" text="Export" />-->
<!--                                <Button fx:id="printButton" mnemonicParsing="false" onAction="#printData" prefHeight="18.0" prefWidth="46.0" styleClass="histogram-export-button" text="Print" />-->
<!--                                <Label fx:id="printLabel" styleClass="admin-text" />-->
<!--                            </children>-->
<!--                        </HBox>-->
<!--                    </children>-->
<!--                </VBox>-->
<!--            </children>-->
<!--            <BorderPane.margin>-->
<!--                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />-->
<!--            </BorderPane.margin>-->
<!--        </VBox>-->
    </top>
    <center>
        <AnchorPane BorderPane.alignment="CENTER">
            <children>
                <VBox alignment="CENTER" layoutX="50.0" layoutY="14.0" prefHeight="541.0" prefWidth="800.0" AnchorPane.leftAnchor="50.0" AnchorPane.rightAnchor="50.0">
                    <children>

                        <!-- Title centered and larger -->
                        <Label alignment="CENTER" contentDisplay="CENTER" styleClass="admin-text" text="HISTOGRAM" textAlignment="CENTER" textFill="WHITE">
                            <font>
                                <Font name="System Bold" size="22.0" />
                            </font>
                        </Label>
                        <Label fx:id="histogramTitleLabel" styleClass="histogram-title" text="Distribution of Click Costs" textFill="WHITE">
                            <font>
                                <Font size="16.0" />
                            </font>
                            <VBox.margin>
                                <Insets bottom="5.0" />
                            </VBox.margin>
                        </Label>
                        <StackPane>
                            <children>
                                <BarChart fx:id="histogramChart" animated="false" legendSide="RIGHT" prefHeight="454.0" prefWidth="817.0" styleClass="histogram-bar-chart">
                                    <xAxis>
                                        <CategoryAxis label="Click Cost Range" side="BOTTOM" tickLabelFill="WHITE" fx:id="xAxis" />
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis fx:id="yAxis" forceZeroInRange="true" label="Frequency" side="LEFT" tickLabelFill="WHITE" />
                                    </yAxis>
                                    <padding>
                                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                    </padding>
                                </BarChart>
                            </children>
                        </StackPane>
                        <TextArea fx:id="descriptionTextArea" editable="false" prefHeight="57.0" prefWidth="820.0" styleClass="histogram-text-area" wrapText="true">
                            <VBox.margin>
                                <Insets top="10.0" />
                            </VBox.margin>
                            <font>
                                <Font size="12.0" />
                            </font>
                        </TextArea>
                    </children>
                </VBox>
            </children>
        </AnchorPane>
    </center>
    <bottom>
        <HBox alignment="CENTER" spacing="20.0" BorderPane.alignment="CENTER">
            <BorderPane.margin>
                <Insets bottom="20.0" top="10.0" />
            </BorderPane.margin>
        </HBox>
    </bottom>
</BorderPane>
